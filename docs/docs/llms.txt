# Deep Lake

> Deep Lake is a multi-modal AI database with TQL (Tensor Query Language) for vector similarity search, text search, and complex data operations across cloud storage. It provides native support for embeddings, images, text, and other AI data types with efficient indexing and cross-cloud querying capabilities.

## Dataset API

**Creation & Access:**
```python
ds = deeplake.create("s3://bucket/path")  # Create new dataset
ds = deeplake.open("s3://bucket/path")    # Read-write access  
ds = deeplake.open_read_only("path")      # Read-only access
ds = deeplake.like(source_ds, "new/path") # Copy schema
ds = deeplake.from_parquet("file.parquet", "path") # Import from Parquet
```

**Dataset Operations:**
```python
ds.add_column(name, type)     # Add new column
ds.append(data)              # Add data rows
ds.extend(other_dataset)     # Merge datasets  
ds.delete()                  # Delete dataset
ds.summary()                 # Dataset info
ds.pytorch()                 # PyTorch integration
ds.tensorflow()              # TensorFlow integration
```

## Column API  

**Column Access:**
```python
column = ds["column_name"]      # Get column
column[0:100]                   # Slice data
column.metadata                 # Column metadata
column.name                     # Column name
```

**Indexing:**
```python
column.create_index("embedding")        # Vector index
column.create_index("inverted")         # Text search index
column.create_index("btree")           # Numeric index
```

## Data Types

**Basic Types:** `"int32"`, `"float32"`, `"float64"`, `"bool"`, `"text"`

**AI-Optimized Types:**
```python
types.Image(sample_compression="jpeg")         # Images with compression
types.Embedding(dim, index_type="embedding")   # Vector embeddings
types.Text(index_type="inverted")             # Text with search index
types.Audio(sample_compression="mp3")          # Audio files
types.Video(sample_compression="mp4")          # Video files
types.Medical(compression="dcm")               # Medical imaging (DICOM, NIfTI)
types.Mesh()                                   # 3D meshes (STL, PLY formats)
types.BoundingBox()                           # Object detection boxes
types.SegmentMask(sample_compression="lz4")   # Segmentation masks
types.ClassLabel(names=["cat", "dog"])        # Classification labels
types.Array(dtype, shape)                     # Custom arrays
```

**Index Types:**
- `"embedding"`: Vector similarity search (cosine, L2, etc.)
- `"inverted"`: Text keyword search  
- `"btree"`: Numeric range queries
- `"hash"`: Exact value lookups

## TQL (Tensor Query Language)

**Basic Syntax:**
```sql
-- Single dataset query (no FROM needed)
SELECT * WHERE id > 10

-- Cross-dataset query (FROM required)  
SELECT * FROM "s3://bucket/dataset" WHERE condition
```

**Vector Similarity Search:**
```sql
-- Cosine similarity (higher = more similar)
SELECT * ORDER BY COSINE_SIMILARITY(embeddings, ARRAY[0.1,0.2,0.3]) DESC LIMIT 100

-- L2/Euclidean distance (lower = more similar) 
SELECT * ORDER BY L2_NORM(embeddings - ARRAY[0.1,0.2,0.3]) ASC LIMIT 100

-- L1/Manhattan distance
SELECT * ORDER BY L1_NORM(embeddings - ARRAY[0.1,0.2,0.3]) ASC LIMIT 100

-- Inner product similarity
SELECT * ORDER BY INNER_PRODUCT(embeddings, ARRAY[0.1,0.2,0.3]) DESC LIMIT 100
```

**Text Search:**
```sql  
-- BM25 semantic search
SELECT * ORDER BY BM25_SIMILARITY(text, 'search query') DESC LIMIT 10

-- Keyword search (requires inverted index)
SELECT * WHERE CONTAINS(text, 'keyword')

-- Full text search
SELECT * WHERE text LIKE '%pattern%'
```

**Array Operations:**
```sql
-- Array slicing
SELECT features[:, 0:10] FROM dataset

-- Array filtering  
SELECT * WHERE features[0] > 0.5

-- Array aggregation
SELECT AVG(features, axis=0) FROM dataset
```

**Cross-Cloud Joins:**
```sql
-- Join datasets across cloud providers
SELECT i.image, e.embedding, m.metadata
FROM "s3://bucket1/images" AS i
JOIN "gcs://bucket2/embeddings" AS e ON i.id = e.image_id  
JOIN "azure://container/meta" AS m ON i.id = m.image_id
WHERE m.verified = true
ORDER BY COSINE_SIMILARITY(e.embedding, ARRAY[0.1,0.2,0.3]) DESC
```

**Complex Filtering:**
```sql
-- Combine filters with vector search
SELECT * FROM dataset 
WHERE label IN ('cat', 'dog') AND confidence > 0.9
ORDER BY COSINE_SIMILARITY(embeddings, ARRAY[0.1,0.2,0.3]) DESC
LIMIT 100
```

**Aggregations:**
```sql  
-- Statistical functions
SELECT COUNT(*), AVG(confidence), MAX(score) FROM dataset
GROUP BY label

-- Array statistics
SELECT AVG(embeddings, axis=0), STD(embeddings, axis=1) FROM dataset
```

## Query Execution

**Synchronous:**
```python
results = deeplake.query("SELECT * FROM dataset WHERE condition")
results = ds.query("SELECT * WHERE condition")  # On dataset instance
```

**Asynchronous:**
```python
future = deeplake.query_async("SELECT * FROM dataset WHERE condition")
results = future.result()  # Get results when ready
is_done = future.is_completed()  # Check completion status
```

**Query Results:**
```python
# Iterate through results
for item in results:
    image = item["images"]
    label = item["labels"]

# Direct column access (faster)
images = results["images"][0:100]  
labels = results["labels"][:]

# Chain queries on views
view = ds.query("SELECT * WHERE category = 'animals'")
cats = view.query("SELECT * WHERE species = 'cat'") 
```

## Key Features

- **Multi-cloud Storage**: Seamless querying across S3, GCS, Azure
- **Vector Database**: Built-in similarity search with multiple distance metrics
- **Text Search**: BM25 semantic search and keyword matching  
- **ML Integration**: Native PyTorch/TensorFlow data loaders
- **Compression**: Automatic compression for images, video, audio
- **Versioning**: Dataset branching, tagging, and version control
- **Streaming**: Efficient data streaming for large datasets
- **Visualization**: 3D data visualization capabilities

## Documentation

- [Dataset API](https://docs.deeplake.ai/api/dataset/): Complete dataset operations
- [Column API](https://docs.deeplake.ai/api/column/): Column management and indexing  
- [Query API](https://docs.deeplake.ai/api/query/): TQL syntax and examples
- [Data Types](https://docs.deeplake.ai/api/types/): All supported data types
- [TQL Reference](https://docs.deeplake.ai/advanced/tql/): Complete TQL syntax guide